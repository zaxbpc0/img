$(function(){String.prototype.format=function(){var s=arguments;return this.replace(/\{(\d+)\}/g,function(e,a){return a<s.length?s[a]:""})},$.extend({message:function(e){var a={title:"",message:" 操作成功",time:"3000",type:"success",showClose:!0,autoClose:!0,onClose:function(){}};"string"==typeof e&&(a.message=e),"object"==typeof e&&(a=$.extend({},a,e));var s,i=a.showClose?'<div class="c-message--close">×</div>':"",e=""!==a.title?'<h2 class="c-message__title">'+a.title+"</h2>":"",e='<div class="c-message animated animate__slideInRight"><i class=" c-message--icon c-message--'+a.type+'"></i><div class="el-notification__group">'+e+'<div class="el-notification__content">'+a.message+"</div>"+i+"</div></div>",i=$("body"),t=$(e),n=function(){t.addClass("animate__slideOutRight"),t.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){o()})},o=function(){t.remove(),a.onClose(a),clearTimeout(s)};$(".c-message").remove(),i.append(t),t.one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){t.removeClass("messageFadeInDown")}),i.on("click",".c-message--close",function(e){n()}),a.autoClose&&(s=setTimeout(function(){n()},a.time))}})});var public_vars=public_vars||{};public_vars.variable=public_vars.variable||{};var sm_duration=.2,sm_transition_delay=150;public_vars.$body=$("body"),public_vars.$pageContainer=public_vars.$body.find(".page-container"),public_vars.$sidebarMenu=public_vars.$body.find(".sidebar-menu"),public_vars.$sidebarProfile=public_vars.$sidebarMenu.find(".sidebar-user-info"),public_vars.$mainMenu=public_vars.$sidebarMenu.find(".main-menu"),public_vars.$sidebarInner=$(".sidebar-menu-inner"),public_vars.$horizontalNavbar=public_vars.$body.find(".navbar.horizontal-menu"),public_vars.$horizontalMenu=public_vars.$horizontalNavbar.find(".navbar-nav"),public_vars.$mainContent=public_vars.$pageContainer.find(".main-content"),public_vars.$userInfoMenu=public_vars.$body.find("nav.navbar.user-info-navbar"),public_vars.$navbar=document.querySelector("nav.navbar"),public_vars.$explore_content=$(".explore-content .details"),public_vars.$explore_loadBtn=$(".explore-container .explore-content .loadmore button"),public_vars.variable.weather='<iframe allowtransparency="true" id="previewIframe" frameborder="0" width="260" height="19" scrolling="no" src="//tianqi.2345.com/plugin/widget/index.htm?debug=true&amp;s=3&amp;z=1&amp;t=1&amp;v=0&amp;d=1&amp;bd=0&amp;k=&amp;f=808080&amp;ltf=009944&amp;htf=ff8000&amp;q=1&amp;e=0&amp;a=1&amp;c=54511&amp;w=200&amp;h=19&amp;align=left"></iframe>',public_vars.variable.action=gindex+"/action/webstack-action",public_vars.variable.explore_page=0,public_vars.variable.explore_pagesize=5;var webStack={init:function(){this.windowSize=$(window).width(),this.siteEventInit(),this.resetStyle(),this.toggleBarInit(),this.weatherInit(),this.exploreInit(),this.loadmoreInit()},resetStyle:function(){768<this.windowSize&&this.windowSize<987&&$(".sidebar-menu.toggle-others").addClass("collapsed"),this.resizeNavBar()},weatherInit:function(){768<this.windowSize&&$("li.weather a").append(public_vars.variable.weather)},nightModeInit:function(){var e;""===document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/,"$1")?22<(new Date).getHours()||(new Date).getHours()<6?(document.body.classList.add("night"),document.cookie="night=1;path=/"):(document.body.classList.remove("night"),document.cookie="night=0;path=/"):(e=document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/,"$1")||0,0===parseInt(e)?(document.body.classList.remove("night"),document.querySelector("nav.navbar").classList.remove("night")):(document.body.classList.add("night"),document.querySelector("nav.navbar").classList.add("night")))},siteEventInit:function(){$(document).on("click",".has-sub",function(){var i=$(this);$(this).hasClass("expanded")?$(".has-sub ul").each(function(e,a){var s=$(this);i.find("ul")[0]!==a&&setTimeout(function(){s.attr("style","")},300)}):setTimeout(function(){i.find("ul").attr("style","")},300)}),$(".user-info-menu .hidden-sm").click(function(){$(".sidebar-menu").hasClass("collapsed")?$(".has-sub.expanded > ul").attr("style",""):$(".has-sub.expanded > ul").show()}),$("#main-menu li ul li").click(function(){$(this).siblings("li").removeClass("active"),$(this).addClass("active")})},resizeNavBar:function(){var e=public_vars.$navbar;$(".sidebar-menu").hasClass("collapsed")?(e.classList.add("nav-collapsed"),public_vars.$pageContainer[0].classList.add("nav-collapsed")):(e.classList.remove("nav-collapsed"),public_vars.$pageContainer[0].classList.remove("nav-collapsed"))},toggleBarInit:function(){$("a.smooth").click(function(e){if("index"!==npage)return window.location.href=siteUrl+$(this).attr("href"),!1;e.preventDefault(),$("#main-menu li").each(function(){$(this).removeClass("active")}),$(this).parent("li").addClass("active"),public_vars.$mainMenu.add(public_vars.$sidebarProfile).toggleClass("mobile-is-visible"),public_vars.$sidebarInner.toggleClass("onfixed"),$("html, body").animate({scrollTop:$($(this).attr("href")).offset().top-95},{duration:500,easing:"swing"})}),setup_sidebar_menu(),setup_horizontal_menu(),$('a[data-toggle="sidebar"]').each(function(e,a){$(a).on("click",function(e){e.preventDefault(),public_vars.$sidebarMenu.hasClass("collapsed")?public_vars.$sidebarMenu.removeClass("collapsed"):public_vars.$sidebarMenu.addClass("collapsed"),webStack.resizeNavBar()})}),$('a[data-toggle="mobile-menu"]').on("click",function(e){e.preventDefault(),public_vars.$sidebarInner.toggleClass("onfixed"),public_vars.$mainMenu.add(public_vars.$sidebarProfile).toggleClass("mobile-is-visible"),public_vars.$userInfoMenu.hasClass("mobile-is-visible")&&public_vars.$userInfoMenu.toggleClass("mobile-is-visible")}),$('a[data-toggle="user-info-menu"]').on("click",function(e){e.preventDefault(),public_vars.$userInfoMenu.toggleClass("mobile-is-visible"),public_vars.$sidebarInner.removeClass("onfixed"),public_vars.$mainMenu.hasClass("mobile-is-visible")&&public_vars.$mainMenu.toggleClass("mobile-is-visible")})},loadArticles:function(e,d,p,h){var m=public_vars.$explore_content;$.post(public_vars.variable.action,{type:"posts",mid:e,page:d||1,size:p||1},function(e){if(e.status)if(0<e.data.length){for(var a=1===p?1:e.data.length,s=0;s<a;s++){for(var i=e.data[s],t=utils.timeStamp2Date(i.create),n="",o=siteUrl+"usr/themes/WebStack/images/loading.gif",r=siteUrl+"usr/themes/WebStack/images/adminAvatar.png",l=0;l<i.pics.length;l++)i.pics[l]?n+='<div class="el-image"><a href="{0}" data-lightbox="{3}"><img src="{1}" data-src="{2}" class="lazyload"></a></div>'.format(i.pics[l],o,i.pics[l],i.create+l):n+='<div class="el-image"></div>';for(var c="",u=0;u<i.relatedSites.length;u++)c+='<div class="explore-sites"><a href="{0}" target="_blank" class="site"><div class="el-image"><img src="{1}" data-src="{2}" class="el-image__inner lazyload"></div><span class="el-tooltip name text-ellip">{3}</span></a><div class="divide"></div><p class="site-describe text-ellip">{4}</p><span class="add-to-diy"><i class="fa fa-plus-circle" aria-hidden="true"></i> </span></div>'.format(i.relatedSites[u][2],o,i.relatedSites[u][0],i.relatedSites[u][1],i.relatedSites[u][3]);t='<div class="explore-item"><div class="expolre-detail"><div class="detail-publish-time"><div class="time"><img src="{0}"><div class="time-detail">{1}</div></div><div class="category"><span>网站推荐</span></div></div><div class="detail-content">{2}</div><div class="explore-images">{3}</div><div class="explore-sites-container">{4}</div>'.format(r,t,i.text,n,c);1!==a&&1!==d||m.empty(),m.append(t)}public_vars.variable.explore_page=d}else m.append('<div class="explore-item"><div class="expolre-detail"><div>没有更多内容~</div></div></div>'),public_vars.$explore_loadBtn.attr("disabled",!0),public_vars.$explore_loadBtn.text("没有更多");else $.message({title:"错误",message:e,type:"error"}),console.log(e);h&&"function"==typeof h&&h()})},exploreInit:function(){$(".explore-content .tabs a").each(function(e,a){var s=$(a);s.click(function(e){var a=public_vars.$explore_content;public_vars.$explore_loadBtn.attr("disabled",!1),public_vars.$explore_loadBtn.text("加载更多"),a.empty(),s.siblings().removeClass("active"),s.addClass("active"),s.append('<i class="fa fa-spinner fa-spin" aria-hidden="true"></i>');a=s.data("mid");webStack.loadArticles(a,1,1,function(){$(".tabs a i.fa.fa-spinner.fa-spin").remove(),public_vars.variable.explore_page=0})})})},loadmoreInit:function(){public_vars.$explore_loadBtn.click(function(e){var a,s=$(".explore-container .explore-content .tabs a.active");s&&(a=s.data("mid"),s=(s=public_vars.variable.explore_page+1)||1,webStack.loadArticles(a,s,public_vars.variable.explore_pagesize,function(){}))})}},searchWidget={init:function(){this.search()},search:function(){var a=$(".search-icon");a.css("opacity","1");var s=-1,i=0,t={thisSearch:"https://www.baidu.com/s?wd=",thisSearchIcon:"url('/usr/themes/WebStack/images/search_icon.png')",hotStatus:!0,data:[{name:"百度",img:"url('/usr/themes/WebStack/images/search_icon.png') -80px 0px",position:"0px 0px",url:"https://www.baidu.com/s?wd="},{name:"谷歌",img:"url('/usr/themes/WebStack/images/search_icon.png')  -105px 0px",position:"-40px 0px",url:"https://www.google.com/search?q="},{name:"必应",img:"url('/usr/themes/WebStack/images/search_icon.png')  -80px -25px",position:"0px -40px",url:"https://cn.bing.com/search?q="},{name:"好搜",img:"url('/usr/themes/WebStack/images/search_icon.png') -105px -25px",position:"-40px -40px",url:"https://www.so.com/s?q="},{name:"搜狗",img:"url('/usr/themes/WebStack/images/search_icon.png') -80px -50px",position:"0px -80px",url:"https://www.sogou.com/web?query="},{name:"淘宝",img:"url('/usr/themes/WebStack/images/search_icon.png') -105px -50px",position:"-40px -80px",url:"https://s.taobao.com/search?q="},{name:"京东",img:"url('/usr/themes/WebStack/images/search_icon.png') -80px -75px",position:"0px -120px",url:"http://search.jd.com/Search?keyword="},{name:"天猫",img:"url('/usr/themes/WebStack/images/search_icon.png') -105px -75px",position:"-40px -120px",url:"https://list.tmall.com/search_product.htm?q="},{name:"1688",img:"url('/usr/themes/WebStack/images/search_icon.png') -80px -100px",position:"0px -160px",url:"https://s.1688.com/selloffer/offer_search.htm?keywords="},{name:"知乎",img:"url('/usr/themes/WebStack/images/search_icon.png') -105px -100px",position:"-40px -160px",url:"https://www.zhihu.com/search?type=content&q="},{name:"微博",img:"url('/usr/themes/WebStack/images/search_icon.png') -80px -125px",position:"0px -200px",url:"https://s.weibo.com/weibo/"},{name:"B站",img:"url('/usr/themes/WebStack/images/search_icon.png') -105px -125px",position:"-40px -200px",url:"http://search.bilibili.com/all?keyword="},{name:"豆瓣",img:"url('/usr/themes/WebStack/images/search_icon.png') -80px -150px",position:"0px -240px",url:"https://www.douban.com/search?source=suggest&q="},{name:"优酷",img:"url('/usr/themes/WebStack/images/search_icon.png') -105px -150px",position:"-40px -240px",url:"https://so.youku.com/search_video/q_"},{name:"GitHub",img:"url('/usr/themes/WebStack/images/search_icon.png') -80px -175px",position:"0px -280px",url:"https://github.com/search?utf8=✓&q="}]},e=localStorage.getItem("searchData");e&&(t=JSON.parse(e));var n=$("#txt"),o=$("#box ul li");function r(e){return $(e).contents().filter(function(e,a){return 3===a.nodeType}).text().trim()}function l(e){$.ajax({type:"GET",url:"https://sp0.baidu.com/5a1Fazu8AA54nxGko9WTAnF6hhy/su",async:!0,data:{wd:e},dataType:"jsonp",jsonp:"cb",success:function(e){if($("#box ul").text(""),i=e.s.length){$("#box").css("display","block");for(var a=0;a<i;a++)$("#box ul").append("<li><span>"+(a+1)+"</span> "+e.s[a]+"</li>"),(o=$("#box ul li")).eq(a).click(function(){var e=r(this);n.val(e),window.open(t.thisSearch+e),$("#box").css("display","none")}),0===a?(o.eq(a).css({"border-top":"none"}),$("#box ul span").eq(a).css({color:"#fff",background:"#f54545"})):1===a?$("#box ul span").eq(a).css({color:"#fff",background:"#ff8547"}):2===a&&$("#box ul span").eq(a).css({color:"#fff",background:"#ffac38"})}else $("#box").css("display","none")},error:function(e){console.log(e)}})}n.keyup(function(e){$(this).val()?38!==e.keyCode&&40!==e.keyCode&&t.hotStatus&&l($(this).val()):($(".search-clear").css("display","none"),$("#box").css("display","none"))}),n.keydown(function(e){var a;40===e.keyCode?(s===i-1?s=0:s++,o.eq(s).addClass("current").siblings().removeClass("current"),a=r(o.eq(s)),n.val(a)):38===e.keyCode?(e.preventDefault&&e.preventDefault(),e.returnValue&&(e.returnValue=!1),0===s||-1===s?s=i-1:s--,o.eq(s).addClass("current").siblings().removeClass("current"),a=r(o.eq(s)),n.val(a)):13===e.keyCode&&(window.open(t.thisSearch+n.val()),$("#box").css("display","none"),n.blur(),o.removeClass("current"),s=-1)}),n.focus(function(){$(".search-box").css("box-show","inset 0 1px 2px rgba(27,31,35,.075), 0 0 0 0.2em rgba(3,102,214,.3)"),$(this).val()&&t.hotStatus&&l($(this).val())}),n.blur(function(){setTimeout(function(){$("#box").css("display","none")},250)});for(var c=0;c<t.data.length;c++)$(".search-engine-list").append('<li><span style="background:'+t.data[c].img+'"/></span>'+t.data[c].name+"</li>");$(".search-icon, .search-engine").hover(function(){$(".search-engine").css("display","block")},function(){$(".search-engine").css("display","none")});e=$("#hot-btn");e.click(function(){$(this).toggleClass("off"),t.hotStatus=!t.hotStatus,localStorage.searchData=JSON.stringify(t)}),t.hotStatus?e.removeClass("off"):e.addClass("off"),$(".search-engine-list li").click(function(){var e=$(this).index();t.thisSearchIcon=t.data[e].position,a.css("background-position",t.thisSearchIcon),t.thisSearch=t.data[e].url,$(".search-engine").css("display","none"),localStorage.searchData=JSON.stringify(t)}),a.css("background-position",t.thisSearchIcon),$("#search-btn").click(function(){var e=n.val();e?(window.open(t.thisSearch+e),$("#box ul").html("")):n.focus()})}},utils={timeStamp2Date:function(e){"string"==typeof e&&(e=e.length<13?1e3*parseInt(e):parseInt(e));e=new Date(e);return e.getFullYear()+"-"+((e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-")+(e.getDate()<10?"0"+e.getDate():e.getDate())+" "+((e.getHours()<10?"0"+e.getHours():e.getHours())+":")+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())}},WebStackInit=function(){$('[data-toggle="tooltip"]').tooltip(),webStack.init(),searchWidget.init()};function switchNightMode(){var e=document.cookie.replace(/(?:(?:^|.*;\s*)night\s*\=\s*([^;]*).*$)|^.*$/,"$1")||0;0===parseInt(e)?(document.body.classList.add("night"),document.querySelector("nav.navbar").classList.add("night"),document.cookie="night=1;path=/"):(document.body.classList.remove("night"),document.querySelector("nav.navbar").classList.remove("night"),document.cookie="night=0;path=/")}function enterfullscreen(){$("#fullscreen").html(" ");var docElm=document.documentElement;if(docElm.requestFullscreen){docElm.requestFullscreen()}else{if(docElm.mozRequestFullScreen){docElm.mozRequestFullScreen()}else{if(docElm.webkitRequestFullScreen){docElm.webkitRequestFullScreen()}else{if(elem.msRequestFullscreen){elem.msRequestFullscreen()}}}}}function exitfullscreen(){$("#fullscreen").html(" ");if(document.exitFullscreen){document.exitFullscreen()}else{if(document.mozCancelFullScreen){document.mozCancelFullScreen()}else{if(document.webkitCancelFullScreen){document.webkitCancelFullScreen()}else{if(document.msExitFullscreen){document.msExitFullscreen()}}}}}var a=0;$("#fullscreen").on("click",function(){a++;a%2==1?enterfullscreen():exitfullscreen()});function isxs(){return is("devicescreen")||is("sdevicescreen")}function get_current_breakpoint(){var e,a=jQuery(window).width(),s=public_vars.breakpoints;for(e in s){var i=s[e],t=i[0],i=i[1];if(-1===i&&(i=a),t<=a&&a<=i)return e}return null}function is(e){return get_current_breakpoint()===e}function sidebar_menu_item_collapse(e,a){var s;e.data("is-busy")||(s=a.children(),e.removeClass("expanded").data("is-busy",!0),s.addClass("hidden-item"),a.animate({height:0},function(){e.data("is-busy",!1).removeClass("opened"),a.attr("style","").hide(),s.removeClass("hidden-item"),e.find("li.expanded ul").attr("style","").hide().parent().removeClass("expanded")}))}function sidebar_menu_close_items_siblings(e){e.siblings().not(e).filter(".expanded, .opened").each(function(e,a){var s=jQuery(a),a=s.children("ul");sidebar_menu_item_collapse(s,a)})}function sidebar_menu_item_expand(i,e){var t,a,s,n;i.data("is-busy")||i.parent(".main-menu").length&&public_vars.$sidebarMenu.hasClass("collapsed")||(i.addClass("expanded").data("is-busy",!0),e.show(),t=e.children(),s=e.outerHeight(),jQuery(window).height(),i.outerHeight(),a=public_vars.$sidebarMenu.scrollTop(),i.position().top,public_vars.$sidebarMenu.hasClass("fit-in-viewport"),t.addClass("is-hidden"),e.height(0),e.animate({height:s},function(){e.height("")}),s=i.data("sub_i_1"),n=i.data("sub_i_2"),window.clearTimeout(s),s=setTimeout(function(){t.each(function(e,a){jQuery(a).addClass("is-shown")});var e=sm_transition_delay*t.length,a=parseFloat(t.eq(0).css("transition-duration")),s=parseFloat(t.last().css("transition-delay"));a&&s&&(e=1e3*(a+s)),window.clearTimeout(n),n=setTimeout(function(){t.removeClass("is-hidden is-shown")},e),i.data("is-busy",!1)},0),i.data("sub_i_1",s),i.data("sub_i_2",n))}function setup_sidebar_menu(){var e,t;public_vars.$sidebarMenu.length&&(e=public_vars.$sidebarMenu.find("li:has(> ul)"),t=public_vars.$sidebarMenu.hasClass("toggle-others"),e.filter(".active").addClass("expanded"),is("largescreen")&&!1===public_vars.$sidebarMenu.hasClass("collapsed")&&$(window).on("resize",function(){is("tabletscreen")?public_vars.$sidebarMenu.addClass("collapsed"):is("largescreen")&&public_vars.$sidebarMenu.removeClass("collapsed")}),e.each(function(e,a){var s=jQuery(a),a=s.children("a"),i=s.children("ul");s.addClass("has-sub"),a.on("click",function(e){e.preventDefault(),t&&sidebar_menu_close_items_siblings(s),(s.hasClass("expanded")||s.hasClass("opened")?sidebar_menu_item_collapse:sidebar_menu_item_expand)(s,i)})}))}function setup_horizontal_menu(){var o,i;public_vars.$horizontalMenu.length&&(o=public_vars.$horizontalMenu.find("li:has(> ul)"),(i=public_vars.$horizontalMenu.hasClass("click-to-expand"))&&public_vars.$mainContent.add(public_vars.$sidebarMenu).on("click",function(e){o.removeClass("hover")}),o.each(function(e,a){var s=jQuery(a),a=s.children("a"),t=s.children("ul"),n=s.parent().is(".navbar-nav");s.addClass("has-sub"),a.on("click",function(e){isxs()&&(e.preventDefault(),sidebar_menu_close_items_siblings(s),(s.hasClass("expanded")||s.hasClass("opened")?sidebar_menu_item_collapse:sidebar_menu_item_expand)(s,t))}),i?a.on("click",function(e){var i;e.preventDefault(),isxs()||(n?(o.filter(function(e,a){return jQuery(a).parent().is(".navbar-nav")}).not(s).removeClass("hover"),s.toggleClass("hover")):0==s.hasClass("expanded")?(s.addClass("expanded"),t.addClass("is-visible"),i=t.outerHeight(),t.height(0),TweenLite.to(t,.15,{css:{height:i},ease:Sine.easeInOut,onComplete:function(){t.attr("style","")}}),s.siblings().find("> ul.is-visible").not(t).each(function(e,a){var s=jQuery(a);i=s.outerHeight(),s.removeClass("is-visible").height(i),s.parent().removeClass("expanded"),TweenLite.to(s,.15,{css:{height:0},onComplete:function(){s.attr("style","")}})})):(i=t.outerHeight(),s.removeClass("expanded"),t.removeClass("is-visible").height(i),TweenLite.to(t,.15,{css:{height:0},onComplete:function(){t.attr("style","")}})))}):s.hoverIntent({over:function(){isxs()||(n?s.addClass("hover"):(t.addClass("is-visible"),sub_height=t.outerHeight(),t.height(0),TweenLite.to(t,.25,{css:{height:sub_height},ease:Sine.easeInOut,onComplete:function(){t.attr("style","")}})))},out:function(){isxs()||(n?s.removeClass("hover"):(sub_height=t.outerHeight(),s.removeClass("expanded"),t.removeClass("is-visible").height(sub_height),TweenLite.to(t,.25,{css:{height:0},onComplete:function(){t.attr("style","")}})))},timeout:200,interval:n?10:100})}))}